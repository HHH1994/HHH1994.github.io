(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-adc46d92"],{"5b67":function(e,t,s){"use strict";s("815b")},"815b":function(e,t,s){},ae17:function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"wrapper"},[t("p",{staticStyle:{"margin-bottom":"20px"}},[e._v("Websocket示例")]),t("section",{staticClass:"service"},[t("HInput",{staticStyle:{width:"500px","margin-right":"10px"},attrs:{placeholder:"请输入websocket的服务连接地址"},model:{value:e.socketConf.path,callback:function(t){e.$set(e.socketConf,"path",t)},expression:"socketConf.path"}}),t("span",{staticClass:"h-btn",on:{click:e.connectHandle}},[e._v("连接")]),t("span",{staticClass:"h-btn",on:{click:e.disconnect}},[e._v("断开")])],1),t("div",{staticStyle:{"margin-bottom":"10px"}},[e.socket.instance&&e.retryTime&&e.retryTime<e.maxReconnectTime+1?t("p",[e._v("正在重新连接中，第"+e._s(e.retryTime)+"次尝试")]):e._e(),e.socket.instance&&e.retryTime&&e.retryTime>=e.maxReconnectTime+1?t("p",[e._v("重新连接失败，请手动连接")]):e._e()]),t("section",{staticClass:"content"},[t("div",{staticClass:"content-lf"},[t("div",{staticClass:"form-item"},[t("label",[e._v("header")]),t("HInput",{attrs:{placeholder:"请输入websocket的头部信息"},model:{value:e.socketConf.header,callback:function(t){e.$set(e.socketConf,"header",t)},expression:"socketConf.header"}})],1),t("div",{staticClass:"form-item"},[t("label",[e._v("message")]),t("HInput",{attrs:{placeholder:"请输入websocket的信息"},model:{value:e.socketConf.message,callback:function(t){e.$set(e.socketConf,"message",t)},expression:"socketConf.message"}}),t("span",{staticClass:"h-btn",staticStyle:{"margin-left":"10px","vertical-align":"middle"},on:{click:e.send}},[e._v("发送")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.isClear,expression:"isClear"}],staticStyle:{"vertical-align":"middle","margin-right":"5px"},attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.isClear)?e._i(e.isClear,null)>-1:e.isClear},on:{change:function(t){var s=e.isClear,n=t.target,c=!!n.checked;if(Array.isArray(s)){var o=null,a=e._i(s,o);n.checked?a<0&&(e.isClear=s.concat([o])):a>-1&&(e.isClear=s.slice(0,a).concat(s.slice(a+1)))}else e.isClear=c}}}),t("span",[e._v("发送后是否清空")])],1),t("div",{staticClass:"form-item"},[t("label",[e._v("最大重连次数")]),t("HInput",{attrs:{placeholder:"请输入最大重连次数"},on:{change:function(t){e.retryTime=0}},model:{value:e.socketConf.maxTime,callback:function(t){e.$set(e.socketConf,"maxTime",t)},expression:"socketConf.maxTime"}})],1)]),t("div",{staticClass:"content-rg"},e._l(e.logs,(function(s,n){return t("p",{key:n,staticClass:"log"},[e._v("\n          "+e._s(n+1)+":"+e._s(s)+"\n      ")])})),0)])])},c=[],o=s("d13a"),a=function(){var e=new Date;return"".concat(e.toLocaleDateString()," ").concat(e.toLocaleTimeString())},i={components:{HInput:o["a"]},data:function(){return{socketConf:{path:"",header:"",message:"",maxTime:""},logs:[],socket:{isConnected:!1,instance:null},retryTime:0,isClear:!1}},computed:{maxReconnectTime:function(){return+this.socketConf.maxTime||5}},methods:{connectHandle:function(){this.retryTime=0,this.connect()},connect:function(){var e=this;if(!(this.socket.isConnected||this.socket.instance&&this.socket.instance.readyState<2))if(this.logs=[],this.socketConf.path)try{var t=this.socket.instance=new WebSocket(this.socketConf.path,[this.socketConf.header||void 0]);console.log("this.socket.instance",this.socket.instance),t.onopen=function(){e.logs.push("服务连接成功  ".concat(a())),e.socket.isConnected=!0,e.retryTime=0},t.onerror=function(t){console.log(t),e.logs.push("发生异常  ".concat(a()))},t.onmessage=function(t){var s=t.data;e.logs.push("接收: ".concat(s,"  ").concat(a()))},t.onclose=function(){e.socket.isConnected=!1,e.logs.push("服务已断开连接  ".concat(a())),e.socket.instance&&e.retryTime<e.maxReconnectTime?e.reconnect():e.retryTime++}}catch(s){console.log("err occur")}else alert("请先填写服务连接")},reconnect:function(){this.retryTime++,this.connect()},disconnect:function(){this.socket.isConnected&&(this.socket.instance.close(),this.socket.instance=null)},send:function(){this.socket.isConnected?(this.logs.push("发送: ".concat(this.socketConf.message,"  ").concat(a())),this.socket.instance.send(this.socketConf.message),this.isClear&&(this.socketConf.message="")):alert("请先连接服务")}}},r=i,l=(s("5b67"),s("2877")),m=Object(l["a"])(r,n,c,!1,null,"548ca4b4",null);t["default"]=m.exports}}]);